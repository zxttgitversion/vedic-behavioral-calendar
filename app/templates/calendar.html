<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Monthly Calendar</title>
  <style>
    :root {
      --bg: #f4f7fc;
      --card: #ffffff;
      --text: #162335;
      --muted: #5f6f85;
      --line: #dbe5f2;
      --green: #1f8f5f;
      --yellow: #b98600;
      --red: #bf3434;
      --accent: #1f4d9f;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", "Noto Sans SC", sans-serif;
      color: var(--text);
      background: linear-gradient(180deg, #eaf1fc 0%, var(--bg) 36%, #f8fbff 100%);
      padding: 20px;
    }
    table.calendar { border-collapse: collapse; width: 100%; max-width: 1100px; margin: 0 auto; }
    table.calendar th { background: transparent; padding: 8px; border-bottom: 1px solid var(--line); color: var(--muted); text-align: left; }
    table.calendar td { vertical-align: top; height: 120px; width: 14%; padding: 10px; border: 1px solid transparent; }

    /* card-like cell */
    td.card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 12px;
    }
    td.empty { background: transparent; }

    .date-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
    .date-num { font-weight:700; color: var(--text); }
    .today-tag { font-size:10px; background:var(--accent); color:#fff; padding:2px 6px; border-radius:6px; margin-left:6px; }

    .dot { display:none; }
    .dot.green { background: var(--green); }
    .dot.yellow { background: var(--yellow); }
    .dot.red { background: var(--red); }

    .signal-green { color: var(--green); }
    .signal-yellow { color: var(--yellow); }
    .signal-red { color: var(--red); }

    .score { font-size:20px; font-weight:700; margin-top:auto; line-height:1; }
    .score-value { display:block; }
    .score-label { display:none; }

    .is-today { border: 2px solid var(--accent) !important; background-color: #f0f7ff; box-shadow: 0 6px 18px rgba(31,77,159,0.06); }

    /* make whole card clickable */
    .cell-link { display:block; color: inherit; text-decoration: none; height:100%; }
    .cell-link:hover { text-decoration: none; }
    .cell-inner { display:flex; flex-direction:column; height:100%; }
    .cell-body { margin-top: auto; }
  </style>
</head>
<body>
  <h2>{{ year }}-{{ "%02d"|format(month) }} Calendar</h2>
  <p><b>Timezone:</b> {{ tz }}</p>

  <table class="calendar">
    <tr>
      {% for name in weekday_names %}
        <th>{{ name }}</th>
      {% endfor %}
    </tr>
    {% for week in weeks %}
      <tr>
        {% for cell in week %}
          {% if cell %}
            <td class="card{% if cell['date'] == today_str %} is-today{% endif %}">
              <a class="cell-link" href="/day/{{ file_id }}/{{ cell['date'] }}">
                <div class="cell-inner">
                  <div class="date-header">
                    <span class="date-num">{{ cell["date"].split('-')[-1] }}</span>
                    {% if cell['date'] == today_str %}<span class="today-tag">Today</span>{% endif %}
                  </div>
                  <div class="cell-body">
                    <div class="score">
                      <span class="score-value signal-{{ cell['signal'] }}">{{ cell["day_score"] }}</span>
                      <span class="score-label">INDEX</span>
                    </div>
                  </div>
                </div>
              </a>
            </td>
          {% else %}
            <td class="empty"></td>
          {% endif %}
        {% endfor %}
      </tr>
    {% endfor %}
  </table>

  <br>
  <a href="/profile/{{ file_id }}">Back to Profile</a>
</body>
</html>
